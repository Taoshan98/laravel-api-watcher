import{o as T,f as l,g as d,j as t,z as R,H as A,u as p,t as m,y as L,m as h,k as b,b as v,c as n,e as B}from"./vendor-charts-B6IHGujI.js";import{u as C}from"./app-DYKFonEC.js";const F={class:"space-y-6 animate-[fade-in_0.3s_ease]"},I={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},q={key:0,class:"space-y-4"},N={key:1,class:"glass-surface p-4 border-l-4 border-danger"},V={class:"text-danger text-sm"},$={key:2,class:"space-y-4"},M={class:"glass-surface p-4 md:p-5"},E={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},H={class:"glass-surface p-4 md:p-5"},P={class:"glass-surface p-4 md:p-5"},U={key:1,class:"h-[320px] flex items-center justify-center text-text-muted text-sm"},W={class:"glass-surface p-4 md:p-5"},X={key:1,class:"h-[200px] flex items-center justify-center text-text-muted text-sm"},Q={__name:"Analytics",setup(G){const{fetchAnalytics:g,loading:_,error:f}=C(),a=v(null),c=v(30),r={chart:{toolbar:{show:!0,tools:{download:!0,zoom:!0,pan:!1,reset:!0}},background:"transparent",fontFamily:"Inter, system-ui, sans-serif"},theme:{mode:"dark"},grid:{borderColor:"rgba(255,255,255,0.06)",strokeDashArray:4,padding:{left:8,right:8}},stroke:{curve:"smooth",width:2},xaxis:{labels:{style:{colors:"#555",fontSize:"11px"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"#555",fontSize:"11px"}}},tooltip:{theme:"dark"},dataLabels:{enabled:!1}},k=n(()=>a.value?{...r,chart:{...r.chart,type:"area",height:340},colors:["#00e5ff"],fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.3,opacityTo:.02,stops:[0,100]}},xaxis:{...r.xaxis,categories:Object.keys(a.value.requests_per_day),labels:{...r.xaxis.labels,formatter:o=>{if(!o)return"";const e=new Date(o);return`${e.getDate()}/${e.getMonth()+1}`}}}}:{}),w=n(()=>a.value?[{name:"Requests",data:Object.values(a.value.requests_per_day)}]:[]),D=n(()=>a.value?{...r,chart:{...r.chart,type:"area",height:340},colors:["#ff1744"],fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.2,opacityTo:.02,stops:[0,100]}},xaxis:{...r.xaxis,categories:Object.keys(a.value.error_rate_trend),labels:{...r.xaxis.labels,formatter:o=>{if(!o)return"";const e=new Date(o);return`${e.getDate()}/${e.getMonth()+1}`}}},yaxis:{...r.yaxis,labels:{...r.yaxis.labels,formatter:o=>(o==null?void 0:o.toFixed(1))+"%"}},annotations:{yaxis:[{y:5,borderColor:"#ff1744",strokeDashArray:4,label:{text:"Threshold 5%",style:{color:"#ff1744",background:"transparent"},position:"front"}}]}}:{}),S=n(()=>a.value?[{name:"Error Rate",data:Object.values(a.value.error_rate_trend)}]:[]),O=n(()=>{if(!a.value)return{};const o=Object.keys(a.value.status_code_distribution),e=o.map(s=>s>=500?"#ff1744":s>=400?"#ffab00":s>=300?"#2979ff":"#00e676");return{chart:{type:"donut",background:"transparent",fontFamily:"Inter, system-ui, sans-serif"},theme:{mode:"dark"},colors:e,labels:o.map(s=>`HTTP ${s}`),legend:{position:"bottom",labels:{colors:"#8a8a8a"}},stroke:{show:!1},plotOptions:{pie:{donut:{size:"72%",labels:{show:!0,total:{show:!0,label:"Total",color:"#8a8a8a",formatter:s=>s.globals.seriesTotals.reduce((i,u)=>i+u,0).toLocaleString()},value:{color:"#f0f0f0",fontSize:"22px",fontWeight:700}}}}},dataLabels:{enabled:!1},tooltip:{theme:"dark"}}}),x=n(()=>a.value?Object.values(a.value.status_code_distribution):[]),j=n(()=>{if(!a.value)return{};const e=a.value.top_slowest_routes.slice(0,10).map(s=>{var i;try{const u=new URL(s.url);return u.pathname.length>35?u.pathname.slice(0,35)+"â€¦":u.pathname}catch{return((i=s.url)==null?void 0:i.slice(0,35))||"unknown"}});return{chart:{type:"bar",background:"transparent",toolbar:{show:!1},fontFamily:"Inter, system-ui, sans-serif"},theme:{mode:"dark"},plotOptions:{bar:{horizontal:!0,borderRadius:4,barHeight:"55%"}},colors:["#ffab00"],xaxis:{categories:e,labels:{style:{colors:"#555",fontSize:"11px"},formatter:s=>s+"ms"},axisBorder:{show:!1}},yaxis:{labels:{style:{colors:"#8a8a8a",fontSize:"11px"},maxWidth:200}},grid:{borderColor:"rgba(255,255,255,0.06)",strokeDashArray:4},dataLabels:{enabled:!0,style:{fontSize:"11px",colors:["#f0f0f0"]},formatter:s=>s+"ms",offsetX:4},tooltip:{theme:"dark",y:{formatter:s=>s+"ms"}}}}),z=n(()=>a.value?[{name:"Avg Duration",data:a.value.top_slowest_routes.slice(0,10).map(o=>o.avg_duration)}]:[]),y=async()=>{try{a.value=await g(c.value)}catch(o){console.error(o)}};return T(y),(o,e)=>{var i;const s=B("apexchart");return l(),d("div",F,[t("div",I,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-2xl font-bold text-text-primary"},"Analytics"),t("p",{class:"text-sm text-text-muted mt-0.5"},"Deep dive into your API performance")],-1)),R(t("select",{"onUpdate:modelValue":e[0]||(e[0]=u=>c.value=u),onChange:y,class:"w-auto"},[...e[1]||(e[1]=[t("option",{value:7},"Last 7 Days",-1),t("option",{value:30},"Last 30 Days",-1),t("option",{value:90},"Last 90 Days",-1)])],544),[[A,c.value]])]),p(_)&&!a.value?(l(),d("div",q,[...e[3]||(e[3]=[t("div",{class:"skeleton h-[340px]"},null,-1),t("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},[t("div",{class:"skeleton h-[340px]"}),t("div",{class:"skeleton h-[340px]"})],-1)])])):m("",!0),p(f)?(l(),d("div",N,[t("p",V,L(p(f)),1)])):m("",!0),a.value?(l(),d("div",$,[t("div",M,[e[4]||(e[4]=t("h3",{class:"text-sm font-semibold text-text-primary mb-4"},"Request Volume",-1)),h(s,{type:"area",height:"340",options:k.value,series:w.value},null,8,["options","series"])]),t("div",E,[t("div",H,[e[5]||(e[5]=t("h3",{class:"text-sm font-semibold text-text-primary mb-4"},"Error Rate Trend",-1)),h(s,{type:"area",height:"320",options:D.value,series:S.value},null,8,["options","series"])]),t("div",P,[e[6]||(e[6]=t("h3",{class:"text-sm font-semibold text-text-primary mb-4"},"Status Code Distribution",-1)),x.value.length?(l(),b(s,{key:0,type:"donut",height:"320",options:O.value,series:x.value},null,8,["options","series"])):(l(),d("div",U,"No data available"))])]),t("div",W,[e[7]||(e[7]=t("h3",{class:"text-sm font-semibold text-text-primary mb-4"},"Top Slowest Routes",-1)),(i=a.value.top_slowest_routes)!=null&&i.length?(l(),b(s,{key:0,type:"bar",height:"380",options:j.value,series:z.value},null,8,["options","series"])):(l(),d("div",X,"No data available"))])])):m("",!0)])}}};export{Q as default};
