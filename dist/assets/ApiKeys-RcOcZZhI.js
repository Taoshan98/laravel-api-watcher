import{o as F,f as a,g as o,m as b,q as T,x as N,y as i,t as y,T as E,j as t,u as S,D as _,F as L,v as $,k as V,z,E as B,G as X,b as d}from"./vendor-charts-B6IHGujI.js";import{c as q,K as J}from"./app-DYKFonEC.js";/**
 * @license lucide-vue-next v0.368.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=q("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),G={class:"space-y-6 animate-[fade-in_0.3s_ease]"},H={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Q={class:"glass-surface overflow-hidden"},W={key:0,class:"p-8 text-center text-text-muted text-sm"},Y={key:1,class:"p-12 text-center"},Z={key:2,class:"divide-y divide-border-subtle"},ee={class:"text-sm font-semibold text-text-primary"},te={class:"flex items-center gap-3 mt-1 text-xs text-text-muted"},se={class:"flex items-center gap-2 flex-shrink-0"},ae=["onClick"],oe=["onClick"],ne=["onClick"],le={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true"},re={class:"relative w-full max-w-md glass-surface-elevated overflow-hidden animate-[slide-up_0.25s_ease]"},ie={class:"px-5 py-4 border-b border-border-subtle"},de={class:"text-base font-semibold text-text-primary"},ce={class:"px-5 py-5"},ue={key:0},xe={key:0,class:"text-sm text-text-secondary mb-4"},me={class:"font-bold text-text-primary"},pe={key:1},ve={key:1,class:"p-4 rounded-xl bg-success-soft border border-success/20"},ye={class:"text-sm text-success font-medium mb-1"},fe={class:"flex items-center gap-2"},be={class:"flex-1 bg-surface-base p-2.5 rounded-lg border border-border-subtle text-xs font-mono break-all text-text-primary"},ge={class:"px-5 py-4 border-t border-border-subtle flex gap-3 justify-end"},_e={__name:"ApiKeys",setup(he){const g=d([]),h=d(!0),x=d(!1),c=d(""),r=d(""),u=d(!1),l=d(!1),m=d(null),p=d(null),k=(s,e="success")=>{p.value={message:s,type:e},setTimeout(()=>p.value=null,3e3)},f=()=>{var s;return(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content")},v=async()=>{h.value=!0;try{const s=await fetch("/api-watcher/api/keys");s.ok&&(g.value=await s.json())}catch(s){console.error("Failed to fetch keys",s)}finally{h.value=!1}},j=s=>{u.value=!0,l.value=!1,m.value=s.id,c.value=s.name,r.value="",x.value=!0},P=s=>{l.value=!0,u.value=!1,m.value=s.id,c.value=s.name,r.value="",x.value=!0},R=async()=>{l.value?await A():u.value?await D():await M()},A=async()=>{try{const s=await fetch(`/api-watcher/api/keys/${m.value}/refresh`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()}});if(s.ok){const e=await s.json();r.value=e.token,await v()}}catch(s){console.error(s)}},D=async()=>{try{(await fetch(`/api-watcher/api/keys/${m.value}`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()},body:JSON.stringify({name:c.value})})).ok&&(await v(),w(),k("Key updated."))}catch(s){console.error(s)}},M=async()=>{try{const s=await fetch("/api-watcher/api/keys",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f()},body:JSON.stringify({name:c.value})});if(s.ok){const e=await s.json();r.value=e.token,await v()}}catch(s){console.error(s)}},I=async s=>{if(confirm("Delete this API key? Access will be revoked immediately."))try{await fetch(`/api-watcher/api/keys/${s}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":f()}}),await v(),k("Key deleted.")}catch(e){console.error(e)}},w=()=>{x.value=!1,c.value="",r.value="",u.value=!1,l.value=!1,m.value=null},O=()=>{navigator.clipboard.writeText(r.value),k("Copied to clipboard!")},C=s=>{const e=new Date(s);return e.toLocaleDateString()+" "+e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return F(v),(s,e)=>(a(),o("div",G,[b(E,{name:"slide-up"},{default:T(()=>[p.value?(a(),o("div",{key:0,class:N(["fixed top-5 right-5 z-50 flex items-center gap-2 px-4 py-3 rounded-xl text-sm font-medium shadow-lg",p.value.type==="error"?"bg-danger text-white":"bg-success text-text-inverted"])},i(p.value.message),3)):y("",!0)]),_:1}),t("div",H,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-2xl font-bold text-text-primary"},"API Keys"),t("p",{class:"text-sm text-text-muted mt-0.5"},"Manage access keys for the Public API")],-1)),t("button",{onClick:e[0]||(e[0]=n=>x.value=!0),class:"flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-accent text-text-inverted rounded-[10px] hover:bg-accent-hover transition-all"},[b(S(U),{class:"w-4 h-4"}),e[2]||(e[2]=_(" Create Key ",-1))])]),t("div",Q,[h.value?(a(),o("div",W,"Loading keys...")):g.value.length===0?(a(),o("div",Y,[b(S(J),{class:"w-10 h-10 mx-auto text-text-muted opacity-40 mb-3"}),e[4]||(e[4]=t("h3",{class:"text-sm font-semibold text-text-primary mb-1"},"No API keys",-1)),e[5]||(e[5]=t("p",{class:"text-xs text-text-muted"},"Create a key to get started.",-1))])):(a(),o("div",Z,[(a(!0),o(L,null,$(g.value,n=>(a(),o("div",{key:n.id,class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 px-5 py-4 hover:bg-surface-hover transition-colors"},[t("div",null,[t("p",ee,i(n.name),1),t("div",te,[t("span",null,"Created "+i(C(n.created_at)),1),e[6]||(e[6]=t("span",null,"•",-1)),t("span",null,"Last used "+i(n.last_used_at?C(n.last_used_at):"Never"),1)])]),t("div",se,[t("button",{onClick:K=>j(n),class:"px-3 py-1.5 text-xs font-medium glass-surface text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-lg transition-all"}," Edit ",8,ae),t("button",{onClick:K=>P(n),class:"px-3 py-1.5 text-xs font-medium glass-surface text-accent hover:bg-accent-soft rounded-lg transition-all"}," Regenerate ",8,oe),t("button",{onClick:K=>I(n.id),class:"px-3 py-1.5 text-xs font-medium glass-surface text-danger hover:bg-danger-soft rounded-lg transition-all"}," Delete ",8,ne)])]))),128))]))]),(a(),V(X,{to:"body"},[b(E,{name:"fade"},{default:T(()=>[x.value?(a(),o("div",le,[t("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:w}),t("div",re,[t("div",ie,[t("h3",de,i(l.value?"Regenerate Key":u.value?"Edit Key":"Create New Key"),1)]),t("div",ce,[r.value?(a(),o("div",ve,[t("p",ye,i(l.value?"Key Regenerated!":"Key Created!"),1),e[12]||(e[12]=t("p",{class:"text-xs text-text-muted mb-3"},"Copy your API key now — you won't see it again.",-1)),t("div",fe,[t("code",be,i(r.value),1),t("button",{onClick:O,class:"px-3 py-2 text-xs font-medium bg-accent text-text-inverted rounded-lg hover:bg-accent-hover transition-all flex-shrink-0"}," Copy ")])])):(a(),o("div",ue,[l.value?(a(),o("p",xe,[e[7]||(e[7]=_(" Regenerate key for ",-1)),t("span",me,i(c.value),1),e[8]||(e[8]=_("? ",-1)),e[9]||(e[9]=t("br",null,null,-1)),e[10]||(e[10]=t("span",{class:"text-danger text-xs font-semibold"},"Current key will stop working immediately.",-1))])):y("",!0),l.value?y("",!0):(a(),o("div",pe,[e[11]||(e[11]=t("label",{class:"text-xs font-semibold text-text-muted uppercase tracking-wider mb-2 block"},"Key Name",-1)),z(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=n=>c.value=n),placeholder:"e.g. Mobile App",class:"w-full"},null,512),[[B,c.value]])]))]))]),t("div",ge,[t("button",{onClick:w,class:"px-4 py-2 text-sm font-medium glass-surface text-text-secondary hover:text-text-primary hover:bg-surface-hover rounded-[10px] transition-all"}," Close "),r.value?y("",!0):(a(),o("button",{key:0,onClick:R,class:N(["px-4 py-2 text-sm font-medium rounded-[10px] transition-all",l.value?"bg-danger text-white hover:bg-red-600":"bg-accent text-text-inverted hover:bg-accent-hover"])},i(l.value?"Regenerate":u.value?"Update":"Create"),3))])])])):y("",!0)]),_:1})]))]))}};export{_e as default};
